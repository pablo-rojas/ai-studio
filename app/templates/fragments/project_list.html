{% set task_labels = {
  "classification": "Classification",
  "anomaly_detection": "Anomaly Detection",
  "object_detection": "Object Detection",
  "oriented_object_detection": "Oriented Object Detection",
  "segmentation": "Segmentation",
  "instance_segmentation": "Instance Segmentation",
  "regression": "Regression",
} %}

{% set task_badge_colors = {
  "classification": "bg-blue-100 text-blue-800 dark:bg-blue-500/20 dark:text-blue-200",
  "anomaly_detection": "bg-emerald-100 text-emerald-800 dark:bg-emerald-500/20 dark:text-emerald-200",
  "object_detection": "bg-fuchsia-100 text-fuchsia-800 dark:bg-fuchsia-500/20 dark:text-fuchsia-200",
  "oriented_object_detection": "bg-violet-100 text-violet-800 dark:bg-violet-500/20 dark:text-violet-200",
  "segmentation": "bg-orange-100 text-orange-800 dark:bg-orange-500/20 dark:text-orange-200",
  "instance_segmentation": "bg-cyan-100 text-cyan-800 dark:bg-cyan-500/20 dark:text-cyan-200",
  "regression": "bg-amber-100 text-amber-800 dark:bg-amber-500/20 dark:text-amber-200",
} %}

<div id="project-grid" class="grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3">
  {% if projects %}
    {% for project in projects %}
    <article
      data-project-id="{{ project.id }}"
      class="space-y-4 rounded-xl border border-slate-200 bg-white p-4 shadow-sm dark:border-slate-800 dark:bg-slate-900"
    >
      <div class="space-y-2">
        <a
          href="/projects/{{ project.id }}/dataset"
          class="block text-base font-semibold text-slate-900 hover:text-blue-700 dark:text-slate-100 dark:hover:text-blue-300"
        >
          {{ project.name }}
        </a>
        <span
          class="inline-flex rounded-full px-2 py-1 text-xs font-medium {{ task_badge_colors.get(project.task, 'bg-slate-100 text-slate-700 dark:bg-slate-700 dark:text-slate-200') }}"
        >
          {{ task_labels.get(project.task, project.task.replace("_", " ") | title) }}
        </span>
      </div>

      <p class="text-xs text-slate-500 dark:text-slate-400">
        Last updated: {{ project.updated_at.strftime("%Y-%m-%d %H:%M UTC") }}
      </p>

      <form
        hx-patch="/api/projects/{{ project.id }}"
        hx-target="#project-grid"
        hx-swap="outerHTML"
        class="flex items-center gap-2"
      >
        <input
          type="text"
          name="name"
          value="{{ project.name }}"
          required
          maxlength="80"
          class="w-full rounded-md border border-slate-300 bg-white px-2 py-1 text-sm text-slate-900 dark:border-slate-700 dark:bg-slate-950 dark:text-slate-100"
        >
        <button
          type="submit"
          class="rounded-md border border-slate-300 px-2 py-1 text-xs font-medium text-slate-700 hover:bg-slate-100 dark:border-slate-700 dark:text-slate-300 dark:hover:bg-slate-800"
        >
          Rename
        </button>
      </form>

      <button
        type="button"
        hx-delete="/api/projects/{{ project.id }}"
        hx-target="#project-grid"
        hx-swap="outerHTML"
        hx-confirm="Delete project '{{ project.name }}'?"
        class="rounded-md border border-red-200 px-3 py-1 text-xs font-medium text-red-700 hover:bg-red-50 dark:border-red-900 dark:text-red-300 dark:hover:bg-red-950/40"
      >
        Delete
      </button>
    </article>
    {% endfor %}
  {% else %}
  <div class="col-span-full rounded-xl border border-dashed border-slate-300 bg-white p-8 text-center dark:border-slate-700 dark:bg-slate-900">
    <p class="text-sm font-medium text-slate-700 dark:text-slate-300">No projects yet.</p>
    <p class="mt-1 text-sm text-slate-500 dark:text-slate-400">Create your first project to get started.</p>
  </div>
  {% endif %}
</div>
