<div id="dataset-summary" class="rounded-xl border border-slate-200 bg-white p-4 dark:border-slate-800 dark:bg-slate-900">
  {% if dataset %}
  <div class="grid grid-cols-1 gap-3 sm:grid-cols-2 xl:grid-cols-4">
    <article class="rounded-lg border border-slate-200 bg-slate-50 p-3 dark:border-slate-700 dark:bg-slate-950/60">
      <p class="text-xs font-medium uppercase tracking-wide text-slate-500 dark:text-slate-400">Images</p>
      <p class="mt-1 text-2xl font-semibold text-slate-900 dark:text-slate-100">{{ dataset.image_stats.num_images }}</p>
    </article>
    <article class="rounded-lg border border-slate-200 bg-slate-50 p-3 dark:border-slate-700 dark:bg-slate-950/60">
      <p class="text-xs font-medium uppercase tracking-wide text-slate-500 dark:text-slate-400">Classes</p>
      <p class="mt-1 text-2xl font-semibold text-slate-900 dark:text-slate-100">{{ dataset.classes | length }}</p>
    </article>
    <article class="rounded-lg border border-slate-200 bg-slate-50 p-3 dark:border-slate-700 dark:bg-slate-950/60">
      <p class="text-xs font-medium uppercase tracking-wide text-slate-500 dark:text-slate-400">Image Size Range</p>
      <p class="mt-1 text-sm font-medium text-slate-900 dark:text-slate-100">
        {{ dataset.image_stats.min_width }}×{{ dataset.image_stats.min_height }} to
        {{ dataset.image_stats.max_width }}×{{ dataset.image_stats.max_height }}
      </p>
    </article>
    <article class="rounded-lg border border-slate-200 bg-slate-50 p-3 dark:border-slate-700 dark:bg-slate-950/60">
      <p class="text-xs font-medium uppercase tracking-wide text-slate-500 dark:text-slate-400">Formats</p>
      <p class="mt-1 text-sm font-medium text-slate-900 dark:text-slate-100">
        {% if dataset.image_stats.formats %}
          {{ dataset.image_stats.formats | join(", ") }}
        {% else %}
          unknown
        {% endif %}
      </p>
    </article>
  </div>

  <div class="mt-4 grid grid-cols-1 gap-4 lg:grid-cols-2">
    <article class="rounded-lg border border-slate-200 p-3 dark:border-slate-700">
      <h3 class="text-sm font-semibold text-slate-900 dark:text-slate-100">Class Distribution</h3>
      {% if dataset.classes %}
      {% set total_images = dataset.image_stats.num_images if dataset.image_stats.num_images else 1 %}
      {% set class_counts = namespace(values={}) %}
      {% for class_name in dataset.classes %}
        {% set _ = class_counts.values.update({class_name: 0}) %}
      {% endfor %}
      {% for image in dataset.images %}
        {% for annotation in image.annotations %}
          {% if annotation.type == "label" and annotation.class_name in class_counts.values %}
            {% set _ = class_counts.values.update({annotation.class_name: class_counts.values[annotation.class_name] + 1}) %}
          {% endif %}
        {% endfor %}
      {% endfor %}
      <div class="mt-3 space-y-2">
        {% for class_name in dataset.classes %}
        {% set class_total = class_counts.values.get(class_name, 0) %}
        {% set percentage = (class_total / total_images) * 100 %}
        <div class="space-y-1">
          <div class="flex items-center justify-between text-xs text-slate-600 dark:text-slate-300">
            <span>{{ class_name }}</span>
            <span>{{ class_total }}</span>
          </div>
          <div class="h-2 rounded-full bg-slate-200 dark:bg-slate-800">
            <div class="h-2 rounded-full bg-blue-600 dark:bg-blue-400" style="width: {{ percentage }}%"></div>
          </div>
        </div>
        {% endfor %}
      </div>
      {% else %}
      <p class="mt-2 text-sm text-slate-600 dark:text-slate-400">No classes in dataset metadata.</p>
      {% endif %}
    </article>

    <article class="rounded-lg border border-slate-200 p-3 dark:border-slate-700">
      <h3 class="text-sm font-semibold text-slate-900 dark:text-slate-100">Import Metadata</h3>
      <dl class="mt-3 space-y-2 text-sm">
        <div class="flex items-start justify-between gap-4">
          <dt class="text-slate-500 dark:text-slate-400">Dataset ID</dt>
          <dd class="text-right font-medium text-slate-900 dark:text-slate-100">{{ dataset.id }}</dd>
        </div>
        <div class="flex items-start justify-between gap-4">
          <dt class="text-slate-500 dark:text-slate-400">Source Format</dt>
          <dd class="text-right font-medium text-slate-900 dark:text-slate-100">{{ dataset.source_format }}</dd>
        </div>
        <div class="flex items-start justify-between gap-4">
          <dt class="text-slate-500 dark:text-slate-400">Imported At</dt>
          <dd class="text-right font-medium text-slate-900 dark:text-slate-100">{{ dataset.imported_at }}</dd>
        </div>
      </dl>
    </article>
  </div>
  {% else %}
  <div class="rounded-lg border border-dashed border-slate-300 p-8 text-center dark:border-slate-700">
    <p class="text-base font-medium text-slate-900 dark:text-slate-100">No dataset imported.</p>
    <p class="mt-1 text-sm text-slate-600 dark:text-slate-400">Use the import button to load images for this project.</p>
  </div>
  {% endif %}
</div>
